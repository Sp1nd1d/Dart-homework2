# Dart-homework2
**Описание homework1 с изменениями из homework2**

**Цель:**
- Создать мобильное приложение для просмотра новостных статей с двумя экранами;
- Реализовать основной экран, отображающий данные, полученные из удаленного API;
- Создать экран, доступный из основного, для просмотра выбранной новостной статьи (фото, заголовок, текст, ссылка с переходом в браузер);
- Поддержать темную и светлую тему;
- Реализован механизм сохранения избранных новостных статей (кнопку “нравится” для новости)”;
- Реализован новый экран с отображением любимых статей.

**API:** https://newsapi.org/ (результат представлен с учётом ограничений бесплатного плана использования)

**Структура проекта:**
```text
lib/
├── main.dart
├── theme.dart
├── data/
│   ├── models/
│   │   └── article.dart
│   └── services/
│       └── api_service.dart
├── domain/
│   └── providers/
│       ├── api_provider.dart
│       ├── favorites_provider.dart
│       └── theme_provider.dart
├── ui/
│   ├── screens/
│   │   ├── home_screen.dart
│   │   ├── detail_screen.dart
│   │   └── favorites_screen.dart
│   └── widgets/
│       └── article_card.dart
test/
├── favorites_provider_test.dart
└── article_card_test.dart
```
```text
main.dart // Точка входа в приложение. Загружает сохранённую тему, инициализирует ProviderScope, запускает NewsApp.
theme.dart // Описывает светлую и тёмную тему ThemeData, используется в main.dart при построении MaterialApp
article.dart // Модель статьи описывающая структуру новости. Содержит методы fromJson и toJson
api_service.dart // API для обращения.
api_provider.dart // DI провайдер apiProvider, внедряет ApiService в нужные места.
favorites_provider.dart // StateNotifierProvider для управления списком избранных статей.
theme_provider.dart // StateNotifierProvider для управления темой приложения.
home_screen.dart // Главный экран со списком новостей, переключением темы, переходом к подробному описанию статьи и в "Избранное".
detail_screen.dart // Экран подробностей с заголовоком, картинкой, частью основного текста и кнопкой "Читать в браузере".
favorites_screen.dart // Экран со списком статей, добавленных в избранное.
article_card.dart // Виджет карточки новости — используется на главном экране и в избранном.
favorites_provider_test.dart // Unit test на логику избранного
article_card_test.dart // Widget test для ArticleCard
```

**Примеры работы:**

![Screenshot](/assets/scr1.JPG "Обновлённый основной экрана в светлой теме")

![Screenshot](/assets/scr2.JPG "Обновлённый основной экрана в тёмной теме")

![Screenshot](/assets/scr3.JPG "Страница избранных")

![Screenshot](/assets/scr4.JPG "Вторичный экран")

![Screenshot](/assets/scr5.JPG "Переход по ссылке статьи")

**Описание картинок:**
<p align="justify">
На 1 и 2 картинках можно заметить основной экран (в светлой и тёмной темах) со списком новостных статей. Каждая статья представлена отдельным блоком с картинкой, наименованием и кратким описанием. Также появился значок сердца для добавления статьи в избранное. <br />
На рисунке 3 представлена стрраница избранных статей. Виджет статьи выглядит так же, как на основной странице. <br />
На 4 картинке представлен вторичный экран, представляющий собой более подробное содержание статьи. Можно заметить наименование, картинку и небольшую часть основного текста статьи (из-за ограничений бесплатного плана использованного API). Также имеется кнопка перехода по ссылке на статью в браузере. <br />
На 5 картинке представлен переход на статью.
</p>

**Дополнение:**
<p align="justify">
Можно заметить, что не у всех статей имеется картинка. В большинстве случаев изображение не грузится из-за CORS-защиты (часто у крупных сайтов, вроде Washington Post). Для таких случаев была добавлена заглушка. <br />
Возможен вариант, когда у какой-либо статьи в запросе отсутствует основной текст или краткое описание. При отсутствии основного текста во вторичном экране будет продублировано краткое описание. При отсутствии основного текста и краткого описания будет написан текст: "Статья доступна только по ссылке ниже.".
</p>
<p align="justify">
Правила flutter_lints включены и нет ошибок/предупреждений/информации (ignore тоже отсутствует). Это продемонстрировано рисунком 6. <br />
</p>

![Screenshot](/assets/scr6.JPG "Просмотр проблем")

<p align="justify">
Код отформатирован (dart format –output=none –set-exit-if-changed . не выдает проблем). Это продемонстрировано рисунком 7. <br />
</p>

![Screenshot](/assets/scr7.JPG "Проверка отформатирования")

<p align="justify">
Реализована пагинация вида «Бесконечный скролл».
</p>

**Тесты:** <br />
Unit test. <br />
Тест-кейс содержит 3 expect:
- Работает ли сохранение и загрузка из SharedPreferences;
- Добавляется ли статья в избранное при первом нажатии;
- Удаляется ли она из избранного при повторном нажатии.

![Screenshot](/assets/scr8.JPG "Результат unit test")

Widget test. <br />
Тест-кейс содержит 5 expect:
- Появляется ли заголовок статьи;
- Появляется ли краткое описание статьи;
- Появляется ли иконка избранного;
- Проверка изображения;
- Проверка отображения катинки.

![Screenshot](/assets/scr9.JPG "Результат widget test")

**Не получилось:**
<p align="justify">
json_serializable или freezed для модели статьи - бесконечная загрузка статей. <br />
APK-файл и работа на Android - не работает Android Studio. <br />
Интеграционные тесты - Web devices are not supported for integration tests yet.
</p>